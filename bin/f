#!/usr/bin/env bash

shellenv=/tmp/shellenv.fish
bindir=$(dirname $0)
export SCRIPTS_DIR="$(cd "$bindir";cd ..;pwd)"

cat > "$shellenv" <<EOF
export PATH="$PATH:/nix/var/nix/profiles/default/bin"

# [n]eovim
function n
  $bindir/n \$argv
end

# [v]vim
function v
  n \$argv
end

# TODO: generate bindings to bin
function php-serve
  $bindir/php-serve \$argv
end

function apply-database
  $bindir/apply-database \$argv
end

function create-database
  $bindir/create-database \$argv
end

function scripts:brew
  $bindir/scripts:brew \$argv
end

function :comment
  $bindir/:comment \$argv
end

function scripts:conf
    cp $SCRIPTS_DIR/rice/aerospace/.aerospace.toml $HOME
    cp -R $SCRIPTS_DIR/rice/sketchybar $HOME/.config/sketchybar

    aerospace reload-config
end

function scripts:init
    # aerospace &
end
EOF

fish -C "source $bindir/../fish/config.fish && source '$shellenv'" $@
